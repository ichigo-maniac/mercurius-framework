CREATE TABLE PRODUCTS(
  uuid CHARACTER VARYING(36) NOT NULL PRIMARY KEY,
  name CHARACTER VARYING(255) NOT NULL,
  code CHARACTER VARYING(255) NOT NULL,
  creationtime TIMESTAMP NOT NULL,
  modificationtime TIMESTAMP NOT NULL,
  shortName CHARACTER VARYING(255),
  main_unit_uuid CHARACTER VARYING(36) REFERENCES UNITS(uuid) ON DELETE SET NULL,
  main_category_uuid CHARACTER VARYING(36) REFERENCES CATEGORIES(uuid) ON DELETE SET NULL,
  catalog_uuid CHARACTER VARYING(36) NOT NULL REFERENCES SHOP_CATALOGS(uuid) ON DELETE RESTRICT,
  description_uuid CHARACTER VARYING(36) REFERENCES BIG_STRINGS(uuid) ON DELETE SET NULL
);

CREATE UNIQUE INDEX PRODUCT_UUID_IDX ON PRODUCTS(uuid);
CREATE INDEX PRODUCT_CODE_IDX ON PRODUCTS(code);
CREATE INDEX PRODUCT_NAME_IDX ON PRODUCTS(name);

CREATE TABLE PRODUCTS_UNITS_LINKS(
  product_uuid CHARACTER VARYING(36) NOT NULL REFERENCES PRODUCTS(uuid),
  unit_uuid CHARACTER VARYING(36) NOT NULL REFERENCES UNITS(uuid)
);

CREATE TABLE PRODUCTS_CATEGORIES_LINKS(
  product_uuid CHARACTER VARYING(36) NOT NULL REFERENCES PRODUCTS(uuid),
  category_uuid CHARACTER VARYING(36) NOT NULL REFERENCES CATEGORIES(uuid)
);


